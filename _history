{"entries":[{"timestamp":1765382536450,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":237,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":33,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":201,"length1":40,"diffs":[[1,"        \"README.md\"\n"]]},{"start1":228,"length1":75,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"test.ts","value":"// aquí va el archivo \"tests\"; esto no se compilará cuando este paquete se utilice como una extensión.\n"},{"type":"added","filename":"dht11.ts","value":"/**\n   * DHT11\n   */\n//%block=\"DHT11\" weight=100 color=#ff8f3f icon=\"\\uf2c9\"\nnamespace dht11 {\n    export enum DHT11Type {\n        //% block=\"temperature(℃)\"\n        TemperatureC = 0,\n        //% block=\"temperature(℉)\"\n        TemperatureF = 1,\n        //% block=\"humidity(0~100%)\"\n        Humidity = 2\n    }\n\n    let dht11Humidity = 0;\n    let dht11Temperature = 0;\n\n    /**\n     * get dht11 temperature and humidity Value\n     * @param pin Analog pin connected to sensor\n     * @param valueType Select temperature(℃/℉) value or humidity percentage\n     */\n    //% blockId=\"bp_dht11\" block=\"DHT11 pin %pin %valueType\"\n    //% tooltip=\"Reads the temperature or humidity from a DHT11 sensor connected to the specified pin.\"\n    //% pin.fieldEditor=\"gridpicker\"\n    //% help=github:pxt-bplab/dht11/README#dht11-dht11value\n    export function dht11value(pin: DigitalPin, valueType: DHT11Type): number {\n        const DHT11_TIMEOUT = 100;\n        const buffer = pins.createBuffer(40);\n        const data = [0, 0, 0, 0, 0];\n        let startTime = control.micros();\n\n        if (control.hardwareVersion().slice(0, 1) !== \"1\") {\n            // V2\n            // V2 bug\n            pins.digitalReadPin(DigitalPin.P0);\n            pins.digitalReadPin(DigitalPin.P1);\n            pins.digitalReadPin(DigitalPin.P2);\n            pins.digitalReadPin(DigitalPin.P3);\n            pins.digitalReadPin(DigitalPin.P4);\n            pins.digitalReadPin(DigitalPin.P10);\n\n            // 1.start signal\n            pins.digitalWritePin(pin, 0);\n            basic.pause(18);\n\n            // 2.pull up and wait 40us\n            pins.setPull(pin, PinPullMode.PullUp);\n            pins.digitalReadPin(pin);\n            control.waitMicros(40);\n\n            // 3.read data\n            startTime = control.micros();\n            while (pins.digitalReadPin(pin) === 0) {\n                if (control.micros() - startTime > DHT11_TIMEOUT) break;\n            }\n            startTime = control.micros();\n            while (pins.digitalReadPin(pin) === 1) {\n                if (control.micros() - startTime > DHT11_TIMEOUT) break;\n            }\n\n            for (let dataBits = 0; dataBits < 40; dataBits++) {\n                startTime = control.micros();\n                while (pins.digitalReadPin(pin) === 1) {\n                    if (control.micros() - startTime > DHT11_TIMEOUT) break;\n                }\n                startTime = control.micros();\n                while (pins.digitalReadPin(pin) === 0) {\n                    if (control.micros() - startTime > DHT11_TIMEOUT) break;\n                }\n                control.waitMicros(28);\n                if (pins.digitalReadPin(pin) === 1) {\n                    buffer[dataBits] = 1;\n                }\n            }\n        } else {\n            // V1\n            // 1.start signal\n            pins.digitalWritePin(pin, 0);\n            basic.pause(18);\n\n            // 2.pull up and wait 40us\n            pins.setPull(pin, PinPullMode.PullUp);\n            pins.digitalReadPin(pin);\n            control.waitMicros(40);\n\n            // 3.read data\n            if (pins.digitalReadPin(pin) === 0) {\n                while (pins.digitalReadPin(pin) === 0);\n                while (pins.digitalReadPin(pin) === 1);\n\n                for (let dataBits = 0; dataBits < 40; dataBits++) {\n                    while (pins.digitalReadPin(pin) === 1);\n                    while (pins.digitalReadPin(pin) === 0);\n                    control.waitMicros(28);\n                    if (pins.digitalReadPin(pin) === 1) {\n                        buffer[dataBits] = 1;\n                    }\n                }\n            }\n        }\n\n        for (let i = 0; i < 5; i++) {\n            for (let j = 0; j < 8; j++) {\n                if (buffer[8 * i + j] === 1) {\n                    data[i] += 2 ** (7 - j);\n                }\n            }\n        }\n\n        if (((data[0] + data[1] + data[2] + data[3]) & 0xff) === data[4]) {\n            dht11Humidity = data[0] + data[1] * 0.1;\n            dht11Temperature = data[2] + data[3] * 0.1;\n        }\n\n        switch (valueType) {\n            case DHT11Type.TemperatureC:\n                return Math.round(dht11Temperature);\n            case DHT11Type.TemperatureF:\n                return Math.round(dht11Temperature * 1.8 + 32);\n            case DHT11Type.Humidity:\n                return Math.round(dht11Humidity);\n        }\n    }\n}\n"}]}],"snapshots":[{"timestamp":1765382536449,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"DHT11\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}}],"shares":[],"lastSaveTime":1765382669393}